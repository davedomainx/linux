https://spredzy.wordpress.com/2013/10/16/the-foreman-pxe-provisioning-with-libvirt/
http://emeraldreverie.org/blog/2012/10/26/creating-development-environment-with/
https://lukas.zapletalovi.com/2013/04/managing-many-servers-with-foreman.html
http://blog.daniellobato.me/unattended-deployments-of-fedora-and-rhel-atomic-with-foreman/
https://m0dlx.com/blog/Automatic_DNS_updates_from_libvirt_guests.html
https://beryju.org/en/blog/getting-started-foreman-part-1
https://blog.zhaw.ch/icclab/tag/foreman/

libvirtd/dnsmasq
http://libvirt-users.redhat.narkive.com/qikKeDfI/how-to-disable-dnsmasq-from-starting-automatically-with-libvirtd

ipv6 interafce
https://binaryfury.wann.net/2016/03/installing-centos-7-on-an-ipv6-only-system/

Issue with spacewalk after yum -y update.
spacewalk has alot of components/moving parts (foreman has even more but I
digress).

Had a closer look at spacewalk...

Spacewalk is (was) the upstream for Satellite <= 5, but looks like RedHat
went their own way for Satellite 6.

aha saw web comments that RedHat are ditching Satellite and moving to theforeman ?

=== theforeman ===

it is surprisingly dense and unintuitive to go through

=== theforeman -> qemu ===

# FIXME : Changed /etc/libvirt/libvirtd.conf to explictly stop using polkit
# couldnt stop error:
# 2017-05-25 10:08:49.676+0000: 13426: error : virPolkitCheckAuth:133 : authentication unavailable: no polkit agent available to authenticate action 'org.libvirt.unix.manage'

[root@daveserver libvirt]# grep auth_unix /etc/libvirt/libvirtd.conf
#auth_unix_ro = "none"
auth_unix_rw = "none"

systemctl restart libvirtd

Websocket error when trying to access console of VM from foreman:
  Added daveserver.localdomain to windows hosts file
  run insecure https from localhost
  I think I clicked through on the striked-out https and then reloaded page,
  that seems to have worked
  er no it was using https://daveserver.localdomain as the URL that worked ..

 ERF12-6899 [ProxyAPI::ProxyException]: Unable to set DHCP entry ([RestClient::BadRequest]: 400 Bad Request) for proxy
   systemctl restart foreman-proxy.service

Failed to create a compute libvirt (Libvirt) instance will-widell.localdomain: undefined method `merge' for nil:NilClass
 ..

Firewalld blocking VNC console
 firewall-cmd --permanent --add-port=5910-5930/tcp # FIXME : better src restrictions

yum install -y foreman-console
 just one file, is it really doing anything ?

foreman-installer --list-scenarios
ls '/etc/foreman-installer/scenarios.d/

Ah okay I can direct-edit the Bridges in the daveserver.localdomain host

Finally got pxeboot working.. vmlinux and initrd were 0 bytes when copied from
the CentOS ISO ..
https://groups.google.com/forum/#!topic/foreman-users/oguMH7ig7kU

Hm I can connect using curl but not browser
  is firewall
  but then get "cannot read client cert from environment"
[root@daveserver foreman-proxy]# curl -k https://daveserver.localdomain:8443/features
["dhcp","dns","logs","puppet","puppetca","tftp"][root@daveserver foreman-proxy]#
[root@daveserver foreman-proxy]#

failed to fetch kickstart from daveserver.localdomain/unattended
 https://daveserver.davedomain/unattended/provision?spoof=192.168.122.123
 had wrong nameserver - dracut shell couldnt resolve daveserver
   didnt fix it ..
   localdomain is the problem ..
 allow firewalld nfsd ports

firewall-cmd --permanent --add-service=nfs
firewall-cmd --permanent --add-service=mountd
firewall-cmd --permanent --add-service=rpc-bind
firewall-cmd --permanent --add-service=ftp

setup vsftpd

looks like the CA puppet SSL was still set to daveserver.localdomain somehow ..

puppet resource service puppet ensure=stopped
puppet resource service puppetserver ensure=stopped
cd /etc/puppetlabs/puppet/
mv ssl ssl.localdomain
puppet cert list -a --noop

<CA key is created>

cd ssl/ca
openssl x509 -in ./ca_crt.pem -text -noout # confirm has good FQDN


[root@daveserver ca]# puppet master --no-daemonize --verbose
Info: Caching certificate for ca
Info: Creating a new SSL key for daveserver.davedomain
Info: csr_attributes file loading from /etc/puppetlabs/puppet/csr_attributes.yaml
Info: Creating a new SSL certificate request for daveserver.davedomain
Info: Certificate Request fingerprint (SHA256): DE:A2:D4:0A:04:43:65:28:59:92:2D:81:45:CC:3E:CD:5B:DE:7B:D1:00:D7:0D:63:F1:F3:5A:19:60:D8:BE:97
Notice: daveserver.davedomain has a waiting certificate request
Info: authstore: defaulting to no access for daveserver.davedomain
Notice: Signed certificate request for daveserver.davedomain
Notice: Removing file Puppet::SSL::CertificateRequest daveserver.davedomain at '/etc/puppetlabs/puppet/ssl/ca/requests/daveserver.davedomain.pem'
Notice: Removing file Puppet::SSL::CertificateRequest daveserver.davedomain at '/etc/puppetlabs/puppet/ssl/certificate_requests/daveserver.davedomain.pem'
Warning: The WEBrick Puppet master server is deprecated and will be removed in a future release. Please use Puppet Server instead. See http://links.puppetlabs.com/deprecate-rack-webrick-servers for more information.
   (at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/master.rb:210:in `main')
Notice: Starting Puppet master version 4.10.1

^C
puppet resource service puppetserver ensure=running
puppet resource service puppet ensure=running

dnsmasq = off
